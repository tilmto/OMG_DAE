# OMG_DAE

## Environment
*python* : 3.6.4

*tensorflow* : 1.4.0

## Function of each file
*DAE_model.py* : Define the structure of our model and the main function.

*train_data_input.py* : Input the training data comprised by face expressions extracted from each frame and corresponding audio strength.

*val_data_input.py* : Input the test data.

*calculateCCC.py* : Compute the CCC index offered by OMG organizer.

*prediction_complement.py* : Complement the blank of empathy predictions if omitting face expression data of corresponding frames.

*ckpt_final* : The check point data generated by our fine-tuning model for making predictions.

## Make predictions
To generate the empathy predictions for the test data, please download the face expressions and audio strength data extracted from the original test videos named ***face_test***,***audio_test*** to the current directory through our [Baidu Cloud](https://pan.baidu.com/s/1fVQgBhll7AtHWpoO1Z2pMQ) , and input the following commands in command line:
```
mkdir val_predict_raw
mkdir val_predict
python DAE_model.py --subject 1 --story 3,6,7 --notrain_mode --video_val face_test --audio_val audio_test --saver ckpt_final
python DAE_model.py --subject 2 --story 3,6,7 --notrain_mode --video_val face_test --audio_val audio_test --saver ckpt_final
python DAE_model.py --subject 3 --story 3,6,7  --notrain_mode --video_val face_test --audio_val audio_test --saver ckpt_final
python DAE_model.py --subject 4 --story 3,6,7  --notrain_mode --video_val face_test --audio_val audio_test --saver ckpt_final
python DAE_model.py --subject 5 --story 3,6,7  --notrain_mode --video_val face_test --audio_val audio_test --saver ckpt_final
python DAE_model.py --subject 6 --story 3,6,7  --notrain_mode --video_val face_test --audio_val audio_test --saver ckpt_final
python DAE_model.py --subject 7 --story 3,6,7  --notrain_mode --video_val face_test --audio_val audio_test --saver ckpt_final
python DAE_model.py --subject 8 --story 3,6,7  --notrain_mode --video_val face_test --audio_val audio_test --saver ckpt_final
python DAE_model.py --subject 9 --story 3,6,7  --notrain_mode --video_val face_test --audio_val audio_test --saver ckpt_final
python DAE_model.py --subject 10 --story 3,6,7  --notrain_mode --video_val face_test --audio_val audio_test --saver ckpt_final
```
The prediction files will be in the directory *val_predict* in csv format.

## Training
To train an ideal model, please download the face expressions and audio strength data extracted from the original training videos named ***face_train***,***audio_train*** to the current directory through our [Baidu Cloud](https://pan.baidu.com/s/1fVQgBhll7AtHWpoO1Z2pMQ) , and input the following commands in command line:
```
mkdir ckpt
python DAE_model.py --subject 1 --story 1,2,8 --steps 60000 --w_distrib 0.8 --saver ckpt
```
The check point data in the training process will be saved in the directory *ckpt*.

## Tuning parameters in DAE_model.py:
To figure out the meaning of parameters in our model DAE_model.py, please input the following commands in command line:
```
python DAE_model.py -h
```
then you will see the explanation.

